<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<ScrollPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.bschooleventmanager.eventmanager.controller.client.PaymentController"
            fitToWidth="true" 
            vbarPolicy="AS_NEEDED" 
            hbarPolicy="NEVER"
            pannable="false"
            style="-fx-background-color: #f8f9fa; -fx-background: #f8f9fa;">

<VBox spacing="25" style="-fx-background-color: #f8f9fa; -fx-cache: true;"
      cache="true" cacheHint="SPEED">
    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="20">
        <Button fx:id="backButton" 
                text="â† Retour"
                onAction="#handleBack"
                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-background-radius: 6; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 10 15 10 15;"/>
        
        <Region HBox.hgrow="ALWAYS"/>
        
        <Label text="Paiement sÃ©curisÃ©" 
               style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
    </HBox>

    <Separator style="-fx-background-color: #bdc3c7;"/>

    <!-- RÃ©sumÃ© de la rÃ©servation -->
    <VBox spacing="15" styleClass="card-light-shadow" style="-fx-padding: 20px;">
        
        <Label text="ðŸ“‹ RÃ©sumÃ© de votre rÃ©servation" 
               style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #34495e;"/>
        
        <VBox fx:id="reservationSummaryContainer" spacing="8">
            <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->
        </VBox>
        
        <Separator style="-fx-background-color: #ecf0f1;"/>
        
        <HBox alignment="CENTER_LEFT" spacing="20">
            <Label text="Montant Ã  payer :" style="-fx-font-weight: bold; -fx-font-size: 18px; -fx-text-fill: #2c3e50;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="totalAmountLabel" text="0,00 â‚¬" 
                   style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
        </HBox>
    </VBox>

    <!-- SÃ©curitÃ© et confiance -->
    <HBox alignment="CENTER" spacing="10" style="-fx-background-color: #e8f5e8; -fx-background-radius: 8; -fx-padding: 15;">
        <Label text="ðŸ”" style="-fx-font-size: 20px;"/>
        <Label text="Paiement 100% sÃ©curisÃ© - Vos donnÃ©es sont protÃ©gÃ©es par chiffrement SSL" 
               style="-fx-font-size: 12px; -fx-text-fill: #27ae60; -fx-font-weight: bold;"
               wrapText="true"/>
    </HBox>

    <!-- MÃ©thode de paiement -->
    <VBox spacing="15" styleClass="card-light-shadow" style="-fx-padding: 25px;">
        
        <Label text="ðŸ’³ MÃ©thode de paiement" 
               style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #34495e;"/>

        <!-- SÃ©lection mÃ©thode -->
        <VBox spacing="10">
            <RadioButton fx:id="creditCardRadio" text="Carte de crÃ©dit / dÃ©bit" selected="true" 
                        style="-fx-font-size: 14px;"/>
            <RadioButton fx:id="stripeRadio" text="Paiement Stripe (Mode test)" 
                        style="-fx-font-size: 14px;"/>
        </VBox>

        <Separator style="-fx-background-color: #ecf0f1;"/>

        <!-- Formulaire carte de crÃ©dit -->
        <VBox fx:id="creditCardForm" spacing="15">
            <GridPane hgap="15" vgap="15">
                <columnConstraints>
                    <ColumnConstraints minWidth="120" halignment="RIGHT"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                </columnConstraints>

                <!-- Nom du porteur -->
                <Label text="Nom du porteur *" GridPane.rowIndex="0" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <TextField fx:id="cardHolderNameField" 
                          promptText="Nom complet comme sur la carte"
                          GridPane.rowIndex="0" GridPane.columnIndex="1"
                          style="-fx-font-size: 14px;"/>

                <!-- NumÃ©ro de carte -->
                <Label text="NumÃ©ro de carte *" GridPane.rowIndex="1" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <TextField fx:id="cardNumberField" 
                          promptText="1234 5678 9012 3456"
                          GridPane.rowIndex="1" GridPane.columnIndex="1"
                          style="-fx-font-size: 14px;"/>

                <!-- Date d'expiration -->
                <Label text="Date d'expiration *" GridPane.rowIndex="2" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <HBox spacing="10" GridPane.rowIndex="2" GridPane.columnIndex="1">
                    <ComboBox fx:id="expiryMonthCombo" promptText="Mois" prefWidth="80"/>
                    <Label text="/" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                    <ComboBox fx:id="expiryYearCombo" promptText="AnnÃ©e" prefWidth="80"/>
                </HBox>

                <!-- CVV -->
                <Label text="Code CVV *" GridPane.rowIndex="3" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <HBox spacing="10" GridPane.rowIndex="3" GridPane.columnIndex="1">
                    <TextField fx:id="cvvField" 
                              promptText="123"
                              prefWidth="80"
                              style="-fx-font-size: 14px;"/>
                    <Label text="â„¹ï¸ 3 ou 4 chiffres au dos de votre carte" 
                           style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d;"/>
                </HBox>
            </GridPane>
        </VBox>

        <!-- Formulaire Stripe -->
        <VBox fx:id="stripeForm" spacing="15" visible="false" managed="false">
            <Label text="Mode test Stripe - Utilisez ces numÃ©ros de test :" 
                   style="-fx-font-weight: bold; -fx-text-fill: #3498db;"/>
            
            <VBox spacing="8" style="-fx-background-color: #f8f9fa; -fx-background-radius: 5; -fx-padding: 15;">
                <Label text="âœ… SuccÃ¨s : 4242424242424242" style="-fx-font-size: 12px; -fx-text-fill: #27ae60;"/>
                <Label text="âŒ Ã‰chec : 4000000000000002" style="-fx-font-size: 12px; -fx-text-fill: #e74c3c;"/>
                <Label text="ðŸ“‹ Nom : Utilisez n'importe quel nom" style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d;"/>
            </VBox>
            
            <GridPane hgap="15" vgap="15">
                <columnConstraints>
                    <ColumnConstraints minWidth="120" halignment="RIGHT"/>
                    <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                </columnConstraints>

                <Label text="Nom *" GridPane.rowIndex="0" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <TextField fx:id="stripeNameField" 
                          promptText="Jean Dupont"
                          GridPane.rowIndex="0" GridPane.columnIndex="1"
                          style="-fx-font-size: 14px;"/>

                <Label text="NumÃ©ro de test *" GridPane.rowIndex="1" GridPane.columnIndex="0"
                       style="-fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                <TextField fx:id="stripeTestCardField" 
                          text="4242424242424242"
                          GridPane.rowIndex="1" GridPane.columnIndex="1"
                          style="-fx-font-size: 14px;"/>
            </GridPane>
        </VBox>
    </VBox>

    <!-- Messages d'erreur -->
    <Label fx:id="errorLabel" 
           wrapText="true"
           style="-fx-font-size: 14px; -fx-text-fill: #e74c3c; -fx-font-weight: bold; -fx-padding: 10; -fx-background-color: #ffeaea; -fx-background-radius: 5;"
           visible="false" managed="false"/>

    <!-- Boutons d'action -->
    <HBox spacing="15" alignment="CENTER">
        <Button fx:id="cancelButton" text="Annuler" onAction="#handleCancel"
                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 15 30 15 30; -fx-font-size: 14px;"/>
                
        <Button fx:id="payButton" text="Payer maintenant" onAction="#handlePayment"
                style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-background-radius: 8; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 15 30 15 30; -fx-font-size: 16px;"/>
    </HBox>

    <!-- Informations lÃ©gales -->
    <VBox spacing="10" style="-fx-padding: 20; -fx-background-color: #f8f9fa; -fx-background-radius: 8;">
        <Label text="En confirmant ce paiement, vous acceptez nos conditions gÃ©nÃ©rales de vente." 
               style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d;"
               wrapText="true"/>
        <Label text="Les donnÃ©es de paiement sont sÃ©curisÃ©es et ne sont pas stockÃ©es sur nos serveurs." 
               style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d; -fx-font-style: italic;"
               wrapText="true"/>
    </VBox>

</VBox>

</ScrollPane>